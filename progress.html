<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>MentalMatters</title>
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <!-- Font Awesome icons (free version)-->
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="css/styles.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/vanilla-calendar-pro/build/vanilla-calendar.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vanilla-calendar-pro/build/vanilla-calendar.min.js" defer></script>
    <style>
        .bg-mark {
            background-color: #a9d9ec !important;
            margin: 3px;
        }

        .bg-mark-angry {
            background-color: #ff0000 !important;
            color: rgb(255, 255, 255) !important;
            margin: 3px;
        }

        .bg-mark-happy {
            background-color: #15ff00 !important;
            margin: 3px;
        }
    </style>
</head>

<body id="page-top">
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav" style="background-color: #68a49c;">
        <!-- style="background-color: #20acc4;" -->
        <div class="container px-4 px-lg-5">
            <a class="navbar-brand" href="#page-top">MentalMatters</a>
            <button class="navbar-toggler navbar-toggler-right" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
                aria-label="Toggle navigation">
                Menu
                <i class="fas fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="daily.html">Daily</a></li>
                    <li class="nav-item"><a class="nav-link" href="help.html">Help</a></li>
                    <li class="nav-item"><a class="nav-link" href="progress.html">Progress</a></li>
                    <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="login.html">Login</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Masthead-->
    <section class="contact-section" style="background-color: #20212b;">
        <div class="container px-4" style="padding-bottom: 1rem; background-color: #20212b;">
            <div class="row gx-4 gx-lg-5 justify-content-center">

                <div class="col-md-4 mb-md-0">
                    <div id="calendar"> </div>
                </div>
                <div class="col-md-4 mb-md-0">
                    <h3 class="text-uppercase text-white-50 mt-5">DATE</h3>
                    <h3 class="text-uppercase text-white" id="target_date">N/A</h3>
                </div>
            </div>

        </div>
    </section>
    <!-- Info-->
    <section class="contact-section" style="background-color: #68a49c;">
        <div class="container px-4" style="padding-bottom: 3rem;">
            <div class="row gx-4 gx-lg-5">
                <div class="row text-center">
                    <h4 class="text-black-100 mb-4" style="font-size: 4rem;">Daily Summary</h4>
                </div>
                <div class="col-md-12 mb-12 mb-md-2">
                    <div class="card py-4 h-100">
                        <div class="card-body text-center">

                            <h3 class="text-uppercase m-0"><i class="fas fa-clipboard"></i> Summary</h3>

                            <hr class="my-4 mx-auto" style="border-color: #e4c662;" />
                            <div class="text-black-50" style="text-align: left;padding: 2rem" id="summary">N/A</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3 mb-md-0">
                    <div class="card py-4 h-100">
                        <div class="card-body text-center">
                            <h1><i class="fas fa-laugh-beam text-warning mb-2"></i></h1>
                            <h3 class="text-uppercase m-0">Happiness</h3>
                            <h3 class="text-uppercase text-warning m-1" id="happiness_score">N/A</h3>
                            <hr class="my-4 mx-auto" style="border-color: #e4c662;" />
                            <div class="text-black-50" id="happiness_text">N/A</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3 mb-md-0">
                    <div class="card py-4 h-100">
                        <div class="card-body text-center">
                            <h1><i class="fas fa-rainbow mb-2" style="color: #55c480"></i></h1>
                            <h3 class="text-uppercase m-0">Best Area</h3>
                            <h3 class="text-uppercase m-1" id="best_score" style="color: #55c480">N/A</h3>
                            <hr class="my-4 mx-auto" style="border-color: #55c480;" />
                            <div class="text-black-50" id="best_text">N/A</div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4 mb-3 mb-md-0">
                    <div class="card py-4 h-100">
                        <div class="card-body text-center">
                            <h1><i class="fas fa-cloud-rain mb-2" style="color: #c75a5a"></i></h1>
                            <h3 class="text-uppercase m-0">Worst Area</h3>
                            <h3 class="text-uppercase m-1" id="worst_score" style="color: #c75a5a">N/A</h3>
                            <hr class="my-4 mx-auto" style="border-color: #c75a5a;" />
                            <div class="text-black-50" id="worst_text">N/A </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="row text-center mt-4">
                <div class="col-md-2 mb-3 mb-md-0"></div>
                <div class="col-md-4 mb-3 mb-md-0">
                    <h4 class="text-black-100" style="font-size: 3rem;">Journal</h4>
                    <div class="card py-4" style="height: 10rem">
                        <div class="card-body text-center">
                            <div class="text-info" id="journal_entry"> N/A
                            </div>
                        </div>
                    </div>

                </div>
                <div class="col-md-4 mb-3 mb-md-0">
                    <h4 class="text-black-100" style="font-size: 3rem;">Wisdom</h4>
                    <div class="card py-4" style="height: 10rem">
                        <div class="card-body text-center">
                            <div class="text-info" id="wisdom">N/A</div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </section>
    <!-- Helper-->
    <section class="" style="background-color: #68a49c;">
        <div class="container px-4" style="padding-top: 2rem;padding-bottom: 2rem; background-color: #68a49c; ">
            <div class="row text-center">
                <h4 class="text-black-100 mb-4" style="font-size: 3rem;">Areas for Improvement</h4>
            </div>
            <div class="row gx-4 gx-lg-5 text-primary">
                <div class="col-md-4 mb-3 mb-md-0" id="exercise" style="display: none;">
                    <div class="card py-4 h-100">
                        <div class="card-body text-center">
                            <h2><i class="fas fa-snowboarding mb-2"></i></h2>
                            <h6 class="text-uppercase m-0"><a href="help.html#portfolioModal1">exercise</a></h6>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3 mb-md-0" id="sleep" style="display: none;">
                    <div class="card py-4 h-100">
                        <div class="card-body text-center">
                            <h2><i class="fas fa-bed"></i></h2>
                            <h6 class="text-uppercase m-0"><a href="help.html#portfolioModal2">sleep</a></h6>
                        </div>
                    </div>
                </div>

                <div class="col-md-4 mb-3 mb-md-0" id="diet" style="display: none;">
                    <div class="card py-4 h-100">
                        <div class="card-body text-center">
                            <h2>
                                <i class="fas fa-utensils"></i>
                            </h2>
                            <h6 class="text-uppercase m-0"><a href="help.html#portfolioModal3">diet</a></h6>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3 mb-md-0" id="mindfulness" style="display: none;">
                    <div class="card py-4 h-100">
                        <div class="card-body text-center">

                            <h2><i class="fab fa-gratipay"></i></h2>
                            <h6 class="text-uppercase m-0"><a href="help.html#portfolioModal4">mindfulness </a></h6>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3 mb-md-0" id="goals" style="display: none;">
                    <div class="card py-4 h-100">
                        <div class="card-body text-center">
                            <h2><i class="fas fa-flag-checkered"></i></h2>
                            <h6 class="text-uppercase m-0"><a href="help.html#portfolioModal5">goals</a></h6>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3 mb-md-0" id="stress" style="display: none;">
                    <div class="card py-4 h-100">
                        <div class="card-body text-center">
                            <h2><i class="fas fa-people-arrows mb-2"></i></h2>
                            <h6 class="text-uppercase m-0"><a href="help.html#portfolioModal6">stress</a></h6>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        </div>
    </section>
    <!-- Info2-->

    <!-- Footer-->
    <footer class="footer bg-black small text-center text-white-50">
        <div class="container px-4 px-lg-5">MentalMatters 2024</div>
        <div class="social d-flex justify-content-center">
            <a class="mx-2" href="https://github.com/chrisl779/mental" target="_blank"><i class="fab fa-github"></i>
                Github </a>
        </div>
    </footer>
    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Core theme JS-->
    <script src="js/scripts.js"></script>
    <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
    <!-- * *                               SB Forms JS                               * *-->
    <!-- * * Activate your form at https://startbootstrap.com/solution/contact-forms * *-->
    <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
    <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
    <script>

        function setDataFromLocalStorage(target) {
            // target : 2024-09-28
            let record = localStorage.getItem(target);
            if (record) { // record existed
                // convert to object
                let obj = JSON.parse(record);
                document.getElementById('happiness_score').textContent = obj.response1.Happiness.score; //setting every text content to the actual score/text
                document.getElementById('happiness_text').textContent = obj.response1.Happiness.text;
                document.getElementById('best_score').textContent = obj.response1['Best Area'].score;
                document.getElementById('best_text').textContent = obj.response1['Best Area'].text;
                document.getElementById('worst_score').textContent = obj.response1['Worst Area'].score;
                document.getElementById('worst_text').textContent = obj.response1['Worst Area'].text;
                document.getElementById('journal_entry').textContent = obj.journal;
                document.getElementById('wisdom').textContent = obj.wisdom;
                if (obj.response1.Summary) {
                    let content = obj.response1.Summary;
                    content = content.replaceAll("\n", "<br>");
                    document.getElementById('summary').innerHTML = content;
                }


                // help
                let test = obj.response2.toLowerCase();
                let sentences = test.split('\n');
                for (let line of sentences) {
                    //console.log(line);
                    if (line.trim().length == 0)
                        continue;
                    line = line.trim();
                    let cIdx = line.length;
                    if (line.indexOf(':') != -1) {
                        cIdx = line.indexOf(':') + 1;
                    }
                    let context = line.substring(cIdx).trim();
                    context = context.charAt(0).toUpperCase() + context.slice(1);
                    //console.log(context) ;
                    if (line.indexOf('sleep') == 0) {
                        document.getElementById('sleep').style.display = "block";
                        document.getElementById('sleep')
                            .children[0]
                            .children[0].innerHTML += `<div class="text-black-50 mt-2">${context}</div>`;
                    }
                    if (line.indexOf('stress') == 0) {
                        document.getElementById('stress').style.display = "block";
                        document.getElementById('stress')
                            .children[0]
                            .children[0].innerHTML += `<div class="text-black-50 mt-2">${context}</div>`;
                    }
                    if (line.indexOf('goals') == 0) {
                        document.getElementById('goals').style.display = "block";
                        document.getElementById('goals')
                            .children[0]
                            .children[0].innerHTML += `<div class="text-black-50 mt-2">${context}</div>`;
                    }
                    if (line.indexOf('mindfulness') == 0) {
                        document.getElementById('mindfulness').style.display = "block";
                        document.getElementById('mindfulness')
                            .children[0]
                            .children[0].innerHTML += `<div class="text-black-50 mt-2">${context}</div>`;
                    }
                    if (line.indexOf('diet') == 0) {
                        document.getElementById('diet').style.display = "block";
                        document.getElementById('diet')
                            .children[0]
                            .children[0].innerHTML += `<div class="text-black-50 mt-2">${context}</div>`;
                    }
                    if (line.indexOf('exercise') == 0) {
                        document.getElementById('exercise').style.display = "block";
                        document.getElementById('exercise')
                            .children[0]
                            .children[0].innerHTML += `<div class="text-black-50 mt-2">${context}</div>`;
                    }
                }

            }

        }

        document.addEventListener("DOMContentLoaded",
            function () {

                sign_in_checker();
                // const quoteInput = document.getElementById("quoteInput");
                // const saveButton = document.getElementById("saveButton");
                // const historyList = document.getElementById("historyList");
                const target = localStorage.getItem('target_date');
                if (target) {
                    document.getElementById('target_date').textContent = target;
                    setDataFromLocalStorage(target);
                }


                // reload the calendar
                function reloadCalendar() {
                    // calendar : mark the dates with record
                    var recs = {};
                    for (let i = 0; i < localStorage.length; i++) {
                        const date = localStorage.key(i);
                        const quote = localStorage.getItem(date);
                        if (quote.indexOf("happy") != -1) {
                            recs[date] = { modifier: 'bg-mark-happy text-bold' };
                        } else if (quote.indexOf("angry") != -1) {
                            recs[date] = { modifier: 'bg-mark-angry text-bold' };
                        } else {
                            recs[date] = { modifier: 'bg-mark text-bold' };
                        }
                    }
                    // https://vanilla-calendar.pro/docs/learn/customization-and-modification/popups
                    const options = {
                        actions: {
                            clickDay(event, self) { // https://vanilla-calendar.pro/docs/learn/action-handlers/click-a-day
                                const quote = localStorage.getItem(self.selectedDates);
                                console.log("===" + self.selectedDates + "===");
                                if (quote) {
                                    localStorage.setItem('target_date', self.selectedDates);
                                    window.location.reload();

                                }
                                console.log(quote);
                            },
                        },
                        popups: recs

                    };
                    const calendar = new VanillaCalendar('#calendar', options);
                    calendar.init();

                }
                reloadCalendar();


            }
        );
    </script>
</body>

</html>